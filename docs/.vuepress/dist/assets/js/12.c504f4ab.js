(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{366:function(n,e,t){"use strict";t.r(e);var r=t(42),s=Object(r.a)({},(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h1",[n._v("让docker中的网站支持https")]),n._v(" "),t("p",[n._v("如何让docker中的网站支持https？通常涉及到两个环节：\n1）nginx前端反向代理到docker，支持https/443 ；\n2）docker内的网站支持https/443。")]),n._v(" "),t("h1",{attrs:{id:"搭建docker环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搭建docker环境"}},[n._v("#")]),n._v(" 搭建docker环境")]),n._v(" "),t("p",[n._v("参考："),t("a",{attrs:{href:"https://steemit.com/@dappcoder/20200605nginxproxy",target:"_blank",rel:"noopener noreferrer"}},[n._v(" docker安装nginx 负载均衡配置  "),t("OutboundLink")],1)]),n._v(" "),t("h1",{attrs:{id:"准备https-所需要的证书"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备https-所需要的证书"}},[n._v("#")]),n._v(" 准备https 所需要的证书")]),n._v(" "),t("p",[n._v("参考："),t("a",{attrs:{href:"https://steemit.com/@dappcoder/20200605nginxproxy",target:"_blank",rel:"noopener noreferrer"}},[n._v(" certbot-auto申请https证书，自动续期  "),t("OutboundLink")],1)]),n._v(" "),t("h1",{attrs:{id:"docker安装nginx并配置https访问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker安装nginx并配置https访问"}},[n._v("#")]),n._v(" docker安装nginx并配置https访问")]),n._v(" "),t("p",[n._v("启动 nginx01 网站的docker：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("sudo su -\nmkdir -p /nginx01/html /nginx01/conf/conf.d /nginx01/logs\necho '80+443 port nginx' > /nginx01/html/index.html \ndocker run -p 8180:80 -p 8143:443 --name nginx01 \\\n  -v /nginx01/html:/usr/share/nginx/html:rw \\\n  -v /nginx01/conf/nginx.conf:/etc/nginx/nginx.conf:rw \\\n  -v /nginx01/conf/conf.d/default.conf:/etc/nginx/conf.d/default.conf:rw \\\n  -v /nginx01/logs:/var/log/nginx:rw \\\n  -v /etc/letsencrypt:/etc/letsencrypt:rw \\\n  -d nginx\n")])])]),t("p",[n._v("同时支持443/80的配置：/nginx01/conf/conf.d/default.conf")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("server{\n    listen 80;\n    listen 443;\n    server_name  w1.huaren.news;\n    #ssl on;\n    ssl_certificate  /etc/letsencrypt/live/huaren.news/fullchain.pem;\n    ssl_certificate_key  /etc/letsencrypt/live/huaren.news/privkey.pem;\n}\n")])])]),t("p",[n._v("强制80跳转443的配置：/nginx01/conf/conf.d/default.conf")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("server {\n    listen 80;\n    server_name w1.huaren.news;\n    return 301 https://$server_name$request_uri;\n}\nserver{\n    listen 443 ssl;\n    ssl on;\n    ssl_certificate  /etc/letsencrypt/live/huaren.news/fullchain.pem;\n    ssl_certificate_key  /etc/letsencrypt/live/huaren.news/privkey.pem;\n}\n")])])]),t("p",[n._v("docker cp sc:/etc/nginx/conf.d/default.conf ~/steemconnect/conf/conf.d")]),n._v(" "),t("h1",{attrs:{id:"宿主机使用nginx向docker容器转发https请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#宿主机使用nginx向docker容器转发https请求"}},[n._v("#")]),n._v(" 宿主机使用nginx向docker容器转发https请求")]),n._v(" "),t("p",[n._v("https://blog.csdn.net/qq_32080545/article/details/85221112")])])}),[],!1,null,null,null);e.default=s.exports}}]);